<!-- tasks/templates/tasks/task_form_content.html -->
<div class="modal-form">
    <div class="modal-header">
        <h2 class="text-xl font-semibold text-white">
            {% if task %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É{% else %}–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞{% endif %}
        </h2>
    </div>
    
    <div class="modal-content space-y-5">
        <form id="taskForm" onsubmit="submitTaskForm(event)" enctype="multipart/form-data">
            {% csrf_token %}
            
            <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">
                    –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *
                </label>
                <input type="text" name="title" 
                       value="{{ task.title|default:'' }}" 
                       required
                       class="w-full px-4 py-2.5 bg-white/5 border border-gray-700/50 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition">
            </div>

            <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">
                    –û–ø–∏—Å–∞–Ω–∏–µ
                </label>
                <textarea name="description" rows="3"
                          class="w-full px-4 py-2.5 bg-white/5 border border-gray-700/50 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition">{{ task.description|default:'' }}</textarea>
            </div>

            <!-- –ü—Ä–æ–µ–∫—Ç –∏ —Å—Ç–∞—Ç—É—Å -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <!-- –ü—Ä–æ–µ–∫—Ç -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        –ü—Ä–æ–µ–∫—Ç
                    </label>
                    <select name="project"
                            class="w-full px-4 py-2.5 bg-white/5 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition">
                        <option value="">-- –ë–µ–∑ –ø—Ä–æ–µ–∫—Ç–∞ --</option>
                        {% for project in projects %}
                        <option value="{{ project.pk }}" 
                                {% if task and task.project.pk == project.pk %}selected{% endif %}>
                            {{ project.title }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- –°—Ç–∞—Ç—É—Å -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        –°—Ç–∞—Ç—É—Å
                    </label>
                    <select name="status"
                            class="w-full px-4 py-2.5 bg-white/5 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition">
                        <option value="todo" {% if task and task.status == 'todo' %}selected{% endif %}>–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</option>
                        <option value="in_progress" {% if task and task.status == 'in_progress' %}selected{% endif %}>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option>
                        <option value="done" {% if task and task.status == 'done' %}selected{% endif %}>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
                        <option value="backlog" {% if task and task.status == 'backlog' %}selected{% endif %}>–û—Ç–ª–æ–∂–µ–Ω–æ</option>
                    </select>
                </div>
            </div>

            <!-- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏ —Å—Ä–æ–∫ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <!-- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1-–≤—ã—Å–æ–∫–∏–π, 5-–Ω–∏–∑–∫–∏–π)
                    </label>
                    <div class="flex items-center gap-4">
                        <input type="range" name="priority" min="1" max="5" 
                               value="{{ task.priority|default:'3' }}"
                               class="flex-1 h-1.5 bg-gray-700/50 rounded-lg appearance-none cursor-pointer slider"
                               oninput="updatePriorityValue(this)">
                        <span id="priorityValue" class="text-lg font-bold text-blue-400 min-w-[20px]">
                            {{ task.priority|default:'3' }}
                        </span>
                    </div>
                </div>

                <!-- –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                    </label>
                    <input type="datetime-local" name="due_date" 
                           value="{% if task and task.due_date %}{{ task.due_date|date:'Y-m-d\\TH:i' }}{% endif %}"
                           class="w-full px-4 py-2.5 bg-white/5 border border-gray-700/50 rounded-lg text-white focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition">
                </div>
            </div>

            <!-- –§–∞–π–ª—ã –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ -->
            {% if not task %}
            <div class="border-t border-gray-800/50 pt-5">
                <h3 class="text-sm font-medium text-gray-300 mb-3">–§–∞–π–ª—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</h3>
                
                <div class="glass-card p-4 rounded-lg">
                    <div class="space-y-3">
                        <div>
                            <input type="file" name="files" multiple
                                   class="w-full px-3 py-1.5 bg-white/5 border border-gray-700/50 rounded text-white text-xs
                                          file:mr-3 file:py-1 file:px-3 file:rounded file:border-0
                                          file:text-xs file:font-medium file:bg-blue-500/20 file:text-blue-400
                                          hover:file:bg-blue-500/30">
                            <p class="text-xs text-gray-500 mt-1">
                                –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤. –ú–∞–∫—Å. 10MB –∫–∞–∂–¥—ã–π.
                            </p>
                        </div>
                        
                        <div class="text-xs text-gray-400">
                            <p>üìå –§–∞–π–ª—ã –±—É–¥—É—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω—ã –∫ –∑–∞–¥–∞—á–µ –ø–æ—Å–ª–µ –µ—ë —Å–æ–∑–¥–∞–Ω–∏—è</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </form>
    </div>

    <div class="modal-footer">
        <button onclick="closeModal()" 
                class="glass-btn px-4 py-2.5 rounded-lg text-sm text-gray-300 hover:text-white transition-colors">
            –û—Ç–º–µ–Ω–∞
        </button>
        <button type="submit" form="taskForm"
                class="glass-btn-primary px-5 py-2.5 rounded-lg text-sm font-medium text-white hover:bg-blue-500/30 transition-colors">
            {% if task %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è{% else %}–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É{% endif %}
        </button>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
        function updatePriorityValue(slider) {
            document.getElementById('priorityValue').textContent = slider.value;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            const slider = document.querySelector('.slider');
            if (slider) {
                updatePriorityValue(slider);
            }
        });
    </script>
</div>