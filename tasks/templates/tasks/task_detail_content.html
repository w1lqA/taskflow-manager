<div class="modal-header">
    <h2 class="text-xl font-semibold text-white">{{ task.title }}</h2>
</div>
<div class="modal-content space-y-6">
    {% if task.description %}
    <div>
        <h3 class="text-sm font-medium text-gray-400 mb-2">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
        <p class="text-gray-300 whitespace-pre-wrap">{{ task.description }}</p>
    </div>
    {% endif %}
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–°—Ç–∞—Ç—É—Å</h3>
            <div class="flex items-center gap-2">
                <span class="status-badge status-{{ task.status }}">
                    {{ task.get_status_display }}
                </span>
            </div>
        </div>
        
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</h3>
            <div class="text-gray-300">–£—Ä–æ–≤–µ–Ω—å {{ task.priority }} –∏–∑ 5</div>
        </div>
        
        {% if task.project %}
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–ü—Ä–æ–µ–∫—Ç</h3>
            <div class="text-gray-300">{{ task.project.title }}</div>
        </div>
        {% endif %}
        
        {% if task.due_date %}
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
            <div class="text-gray-300">{{ task.due_date|date:"d.m.Y H:i" }}</div>
        </div>
        {% endif %}
        
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–°–æ–∑–¥–∞–Ω–∞</h3>
            <div class="text-gray-300">{{ task.created_at|date:"d.m.Y H:i" }}</div>
        </div>
        
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–ò–∑–º–µ–Ω–µ–Ω–∞</h3>
            <div class="text-gray-300">{{ task.updated_at|date:"d.m.Y H:i" }}</div>
        </div>
        
        {% if task.completed_at %}
        <div>
            <h3 class="text-sm font-medium text-gray-400 mb-2">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</h3>
            <div class="text-gray-300">{{ task.completed_at|date:"d.m.Y H:i" }}</div>
        </div>
        {% endif %}
    </div>

    <!-- –°–µ–∫—Ü–∏—è –≤–ª–æ–∂–µ–Ω–∏–π -->
    <div class="border-t border-gray-800/50 pt-6">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-medium text-gray-400">–í–ª–æ–∂–µ–Ω–∏—è</h3>
            <button onclick="showAttachmentForm()"
                    class="glass-btn px-3 py-1.5 rounded-lg text-xs text-gray-300 hover:text-white transition-colors flex items-center gap-1">
                <span>+</span>
                <span>–î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª</span>
            </button>
        </div>

        <!-- –§–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="attachment-form" class="glass-card p-4 rounded-xl mb-4 hidden">
            <form id="uploadForm" enctype="multipart/form-data" class="space-y-3">
                {% csrf_token %}
                <div>
                    <label class="block text-xs font-medium text-gray-300 mb-1">
                        –§–∞–π–ª *
                    </label>
                    <input type="file" name="file" id="fileInput" required
                           class="w-full px-3 py-1.5 bg-white/5 border border-gray-700/50 rounded text-white text-xs
                                  file:mr-3 file:py-1 file:px-3 file:rounded file:border-0
                                  file:text-xs file:font-medium file:bg-blue-500/20 file:text-blue-400
                                  hover:file:bg-blue-500/30">
                    <p class="text-xs text-gray-500 mt-1">
                        –ú–∞–∫—Å. 10MB. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∞—Ä—Ö–∏–≤—ã.
                    </p>
                </div>
                
                <div>
                    <label class="block text-xs font-medium text-gray-300 mb-1">
                        –û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                    </label>
                    <input type="text" name="description" 
                           class="w-full px-3 py-1.5 bg-white/5 border border-gray-700/50 rounded text-white text-xs placeholder-gray-500"
                           placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞">
                </div>
                
                <div class="flex gap-2 pt-2">
                    <button type="button" onclick="hideAttachmentForm()"
                            class="glass-btn px-3 py-1.5 rounded text-xs text-gray-300 hover:text-white">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="button" onclick="uploadAttachment('{{ task.id }}')"
                            class="glass-btn-primary px-4 py-1.5 rounded text-xs text-white">
                        üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –≤–ª–æ–∂–µ–Ω–∏–π -->
        <div id="attachments-list" class="space-y-3">
            {% for attachment in attachments %}
            <div class="glass-card p-4 rounded-lg flex items-start justify-between group hover:border-gray-600/30" 
                 data-attachment-id="{{ attachment.id }}">
                <div class="flex items-start gap-4 flex-1 min-w-0">
                    <!-- –ü—Ä–µ–≤—å—é –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
                    {% if attachment.file_type == 'image' %}
                    <div class="flex-shrink-0">
                        <a href="{{ attachment.file.url }}" target="_blank" class="block">
                            <img src="{{ attachment.file.url }}" 
                                 alt="{{ attachment.original_name }}"
                                 class="w-16 h-16 object-cover rounded-lg border border-gray-700/50 hover:border-blue-500/50 transition-colors">
                        </a>
                    </div>
                    {% else %}
                    <div class="text-2xl flex-shrink-0">
                        {{ attachment.get_file_icon }}
                    </div>
                    {% endif %}
                    
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-2 mb-1">
                            <a href="{{ attachment.file.url }}" 
                               target="_blank"
                               class="text-white text-sm font-medium truncate hover:text-blue-400 transition-colors">
                                {{ attachment.original_name }}
                            </a>
                        </div>
                        
                        <div class="flex items-center gap-3 text-xs text-gray-400 mb-2">
                            <span>{{ attachment.get_readable_size }}</span>
                            <span>{{ attachment.uploaded_at|date:"d.m.Y H:i" }}</span>
                            {% if attachment.description %}
                            <span class="text-gray-500">‚Ä¢ {{ attachment.description }}</span>
                            {% endif %}
                        </div>
                        
                        {% if attachment.file_type == 'image' %}
                        <div class="text-xs text-blue-400">
                            üì∑ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                <button onclick="deleteAttachment('{{ attachment.id }}', this)"
                        class="text-gray-400 hover:text-red-400 p-2 transition-all">
                    üóëÔ∏è
                </button>
            </div>
            {% empty %}
            <div class="glass-card p-6 text-center">
                <div class="text-3xl mb-2 text-gray-600">üìé</div>
                <p class="text-gray-400 text-sm">–ù–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<div class="modal-footer">
    <button onclick="closeModal()" class="glass-btn px-4 py-2 rounded-lg text-sm text-gray-300 hover:text-white">
        –ó–∞–∫—Ä—ã—Ç—å
    </button>
</div>
